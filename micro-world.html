<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <title>–ú–∏–∫—Ä–æ”ô–ª–µ–º - –ö–µ–∑–µ“£–¥–µ—Ä</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&family=Montserrat:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-blue: #00f2ff;
            --neon-green: #00ff88;
            --bg-dark: #020b16;
        }

        body {
            margin: 0; background: var(--bg-dark);
            color: white; font-family: 'Montserrat', sans-serif;
            height: 100vh; display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            overflow: hidden;
        }

        /* –ê—Ä—Ç“õ—ã —Ñ–æ–Ω —ç—Ñ—Ñ–µ–∫—Ç—ñ—Å—ñ */
        .bg-dna {
            position: fixed; width: 100%; height: 100%;
            background: linear-gradient(45deg, #020b16 0%, #051a2e 100%);
            z-index: -1; opacity: 0.8;
        }

        .header {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem; color: var(--neon-blue);
            text-shadow: 0 0 15px var(--neon-blue);
            margin-bottom: 50px; text-transform: uppercase;
        }

        /* –ö–∞—Ä—Ç–∞–Ω—ã“£ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ */
        .map-viewport {
            width: 1100px; height: 500px;
            display: flex; align-items: center;
            position: relative; perspective: 1500px;
        }

        .slider-track {
            display: flex; transition: transform 0.6s cubic-bezier(0.23, 1, 0.32, 1);
            gap: 40px; padding: 0 50px;
            transform-style: preserve-3d;
        }

        /* –ö–µ–∑–µ“£ –∫–∞—Ä—Ç–æ—á–∫–∞—Å—ã (–ò–∑–æ–º–µ—Ç—Ä–∏—è–ª—ã“õ) */
        .stage-card {
            min-width: 220px; height: 320px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--neon-blue);
            border-radius: 20px;
            position: relative; display: flex; flex-direction: column;
            align-items: center; padding: 20px;
            transform: rotateY(-15deg) rotateX(10deg); /* –ò–∑–æ–º–µ—Ç—Ä–∏—è–ª—ã“õ –±“±—Ä—ã—à */
            box-shadow: -10px 10px 20px rgba(0,0,0,0.5);
            transition: 0.4s;
            cursor: pointer;
        }

        .stage-card:hover {
            transform: rotateY(0deg) rotateX(0deg) scale(1.05);
            background: rgba(0, 242, 255, 0.1);
            box-shadow: 0 0 30px var(--neon-blue);
        }

        .stage-num {
            position: absolute; top: -15px; left: -15px;
            width: 45px; height: 45px; background: var(--neon-blue);
            color: #000; border-radius: 50%; display: flex;
            justify-content: center; align-items: center;
            font-weight: bold; font-family: 'Orbitron';
        }

        /* –ò–∫–æ–Ω–∫–∞ –æ—Ä–Ω—ã - —Ç”©—Ä—Ç–±“±—Ä—ã—à –∞–ª—ã–Ω—ã–ø —Ç–∞—Å—Ç–∞–ª–¥—ã, –∂–∞—Ä“õ—ã—Ä–∞—É “õ–æ—Å—ã–ª–¥—ã */
        .stage-icon {
            width: 180px; 
            height: 180px;
            margin: 60px 0;
            /* –§–æ–Ω –º–µ–Ω —Ä–∞–º–∫–∞ –∞–ª—ã–Ω—ã–ø —Ç–∞—Å—Ç–∞–ª–¥—ã */
            display: flex; 
            justify-content: center; 
            align-items: center;
            position: relative;
        }

        .stage-icon img {
            width: 100%; 
            height: 100%; 
            object-fit: contain;
            /* –ò–∫–æ–Ω–∫–∞–Ω—ã“£ ”©–∑—ñ–Ω–µ –Ω–µ–æ–Ω–¥—ã –∂–∞—Ä“õ—ã—Ä–∞—É –±–µ—Ä—É */
            filter: drop-shadow(0 0 10px var(--neon-blue)) drop-shadow(0 0 20px rgba(0, 242, 255, 0.5));
            transition: 0.4s ease;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∞“ì–∞ —Ç—ã—à“õ–∞–Ω–¥—ã –∞–ø–∞—Ä“ì–∞–Ω–¥–∞ –∂–∞—Ä“õ—ã—Ä–∞—É –∫“Ø—à–µ–π–µ–¥—ñ */
        .stage-card:hover .stage-icon img {
            filter: drop-shadow(0 0 15px var(--neon-blue)) drop-shadow(0 0 30px var(--neon-blue));
            transform: scale(1.1); /* –ò–∫–æ–Ω–∫–∞ —Å”ô–ª “Ø–ª–∫–µ–π–µ–¥—ñ */
        }

        .stage-title {
            text-align: center; 
            font-size: 0.9rem; 
            font-weight: 700;
            line-height: 1.3; 
            color: #fff;
            /* –ú”ô—Ç—ñ–Ω–≥–µ –¥–µ –∞–∑–¥–∞–ø –∫”©–ª–µ“£–∫–µ “õ–æ—Å—É –æ“õ—ã–ª—É—ã–Ω –∂–∞“õ—Å–∞—Ä—Ç–∞–¥—ã */
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è –±–∞—Ç—ã—Ä–º–∞–ª–∞—Ä—ã */
        .nav-controls {
            margin-top: 50px; display: flex; gap: 40px;
        }

        .nav-btn {
            background: none; border: 2px solid var(--neon-blue);
            color: var(--neon-blue); padding: 12px 30px;
            border-radius: 30px; cursor: pointer;
            font-family: 'Orbitron'; font-size: 1rem;
            transition: 0.3s;
        }

        .nav-btn:hover:not(:disabled) {
            background: var(--neon-blue); color: #000;
            box-shadow: 0 0 20px var(--neon-blue);
        }

        .nav-btn:disabled {
            opacity: 0.3; cursor: not-allowed; border-color: #555;
        }

        /* “ö“±–ª—ã–ø—Ç–∞–ª“ì–∞–Ω –∫–µ–∑–µ“£ */
        .locked { filter: grayscale(1); opacity: 0.5; }
        .back-home-btn {
            position: fixed;
            top: 30px;
            left: 40px;
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: var(--neon-blue);
            font-family: 'Orbitron', sans-serif;
            font-size: 0.9rem;
            font-weight: bold;
            background: rgba(0, 242, 255, 0.1);
            padding: 12px 20px;
            border: 1px solid var(--neon-blue);
            border-radius: 12px;
            transition: all 0.3s ease;
            z-index: 100; /* –ë–∞—Ä–ª—ã“ì—ã–Ω—ã“£ “Ø—Å—Ç—ñ–Ω–¥–µ —Ç“±—Ä—É—ã “Ø—à—ñ–Ω */
            backdrop-filter: blur(10px);
        }

.back-home-btn .icon {
    font-size: 1.2rem;
}

.back-home-btn:hover {
    background: var(--neon-blue);
    color: #000;
    box-shadow: 0 0 25px var(--neon-blue);
    transform: translateX(5px); /* –°”ô–ª –æ“£“ì–∞ –∂—ã–ª–∂—É —ç—Ñ—Ñ–µ–∫—Ç—ñ—Å—ñ */
}
    </style>
</head>
<body>
    <canvas id="micro-bg"></canvas>

    <style>
        #micro-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1; /* –ë–∞—Å“õ–∞ —ç–ª–µ–º–µ–Ω—Ç—Ç–µ—Ä–¥—ñ“£ –∞—Ä—Ç—ã–Ω–¥–∞ —Ç“±—Ä–∞–¥—ã */
            background: radial-gradient(circle at center, #051a2e 0%, #00050a 100%);
        }
    </style>

    <script>
        const canvas = document.getElementById('micro-bg');
        const ctx = canvas.getContext('2d');

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const particles = [];

        // –ë”©–ª—à–µ–∫—Ç–µ—Ä–¥—ñ“£ (–º–∏–∫—Ä–æ–∞“ì–∑–∞–ª–∞—Ä–¥—ã“£) “õ–∞—Å–∏–µ—Ç—Ç–µ—Ä—ñ
        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.size = Math.random() * 3 + 1; // ”®–ª—à–µ–º—ñ
                this.speedX = Math.random() * 0.5 - 0.25; // “ö–æ–∑“ì–∞–ª—ã—Å –∂—ã–ª–¥–∞–º–¥—ã“ì—ã
                this.speedY = Math.random() * 0.5 - 0.25;
                this.opacity = Math.random() * 0.5 + 0.1;
            }

            update() {
                this.x += this.speedX;
                this.y += this.speedY;

                // –≠–∫—Ä–∞–Ω–Ω–∞–Ω —à—ã“ì—ã–ø –∫–µ—Ç—Å–µ, –µ–∫—ñ–Ω—à—ñ –∂–∞“ì—ã–Ω–∞–Ω –∫—ñ—Ä–≥—ñ–∑—É
                if (this.x > canvas.width) this.x = 0;
                if (this.x < 0) this.x = canvas.width;
                if (this.y > canvas.height) this.y = 0;
                if (this.y < 0) this.y = canvas.height;
            }

            draw() {
                ctx.fillStyle = `rgba(0, 242, 255, ${this.opacity})`; // –ù–µ–æ–Ω–¥—ã –∫”©–∫ —Ç“Ø—Å
                ctx.shadowBlur = 10;
                ctx.shadowColor = '#00f2ff';
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // 100 –±”©–ª—à–µ–∫ –∂–∞—Å–∞—É
        function init() {
            for (let i = 0; i < 100; i++) {
                particles.push(new Particle());
            }
        }

        // –ê–Ω–∏–º–∞—Ü–∏—è —Ü–∏–∫–ª—ñ
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // –§–æ–Ω“ì–∞ –∞–∑–¥–∞–ø "—Ç“±–º–∞–Ω" ”ô—Å–µ—Ä—ñ–Ω “õ–æ—Å—É
            ctx.fillStyle = 'rgba(2, 11, 22, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            particles.forEach(p => {
                p.update();
                p.draw();
            });
            requestAnimationFrame(animate);
        }

        init();
        animate();

        // –≠–∫—Ä–∞–Ω ”©–ª—à–µ–º—ñ ”©–∑–≥–µ—Ä—Å–µ, —Ñ–æ–Ω–¥—ã –¥–∞ ”©–∑–≥–µ—Ä—Ç—É
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
    <div class="bg-dna"></div>
    <h1 class="header">–ú–ò–ö–†–û”ò–õ–ï–ú–ì–ï –°–ê–Ø–•–ê–¢</h1>

    <div class="map-viewport">
        <div class="slider-track" id="slider">
            </div>
    </div>

    <div class="nav-controls">
        <button class="nav-btn" id="prevBtn" disabled>‚¨Ö –ê–†–¢“ö–ê</button>
        <button class="nav-btn" id="nextBtn">–ê–õ“í–ê ‚û°</button>
    </div>

    <script>
        // –ü—Ä–æ–≥—Ä–µ—Å—Ç—ñ —Ç–µ–∫—Å–µ—Ä—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
        function checkProgress() {
            const isStage1Done = localStorage.getItem('stage1_complete');
            
            if (isStage1Done === 'true') {
                const cards = document.querySelectorAll('.stage-card');
                
                // 1-–∫–µ–∑–µ“£–¥—ñ "”®—Ç—ñ–ª–¥—ñ" –¥–µ–ø –±–µ–ª–≥—ñ–ª–µ—É (–º—ã—Å–∞–ª—ã, –∂–∞—Å—ã–ª —Ä–∞–º–∫–∞)
                cards[0].style.borderColor = 'var(--neon-green)';
                cards[0].querySelector('.stage-num').style.background = 'var(--neon-green)';

                // 2-–∫–µ–∑–µ“£–Ω—ñ“£ “õ“±–ª–ø—ã–Ω –∞—à—É
                if (cards[1]) {
                    cards[1].classList.remove('locked');
                    cards[1].style.opacity = '1';
                    cards[1].style.filter = 'none';
                    cards[1].setAttribute('onclick', "window.location.href='stage2.html'");
                }
            }
        }

        // –ë–µ—Ç –∂“Ø–∫—Ç–µ–ª–≥–µ–Ω–¥–µ —Ç–µ–∫—Å–µ—Ä—É–¥—ñ —ñ—Å–∫–µ “õ–æ—Å—É
        window.onload = checkProgress;
        const stages = [
            {id: 1, title: "“ö–∞—É—ñ–ø—Å—ñ–∑–¥—ñ–∫ –µ—Ä–µ–∂–µ—Å—ñ", img: "1.1.png"},
            {id: 2, title: "“ö“±—Ä–∞–ª-–∂–∞–±–¥—ã“õ—Ç–∞—Ä", img: "1..2.png"},
            {id: 3, title: "–ú–∏–∫—Ä–æ—Å–∫–æ–ø “õ“±—Ä—ã–ª—ã—Å—ã", img: "icons/microscope.png"},
            {id: 4, title: "–ñ–∞—Å—É—à–∞ —Ç“Ø—Ä–ª–µ—Ä—ñ", img: "icons/types.png"},
            {id: 5, title: "–ñ–∞—Å—É—à–∞ “õ“±—Ä—ã–ª—ã–º—ã", img: "icons/structure.png"},
            {id: 6, title: "–ü—Ä–µ–ø–∞—Ä–∞—Ç –¥–∞–π—ã–Ω–¥–∞—É", img: "icons/prep.png"},
            {id: 7, title: "2-–º–µ–º–±—Ä–∞–Ω–∞–ª—ã –æ—Ä–≥–∞–Ω–æ–∏–¥—Ç–∞—Ä", img: "icons/membrane2.png"},
            {id: 8, title: "1-–º–µ–º–±—Ä–∞–Ω–∞–ª—ã –æ—Ä–≥–∞–Ω–æ–∏–¥—Ç–∞—Ä", img: "icons/membrane1.png"},
            {id: 9, title: "–ú–µ–º–±—Ä–∞–Ω–∞—Å—ã–∑ –æ—Ä–≥–∞–Ω–æ–∏–¥—Ç–∞—Ä", img: "icons/no-membrane.png"},
            {id: 10, title: "–ñ–∞—Å—É—à–∞–ª—ã“õ –ø—Ä–æ—Ü–µ—Å—Å—Ç–µ—Ä", img: "icons/processes.png"},
            {id: 11, title: "–ë–∞–∫—Ç–µ—Ä–∏—è–ª–∞—Ä", img: "icons/bacteria.png"},
            {id: 12, title: "–í–∏—Ä—É—Å—Ç–∞—Ä", img: "icons/virus.png"},
            {id: 13, title: "–°–∞“£—ã—Ä–∞—É“õ“±–ª–∞“õ—Ç–∞—Ä", img: "icons/fungi.png"},
            {id: 14, title: "–ñ–∞—Å—É—à–∞ –±”©–ª—ñ–Ω—É—ñ", img: "icons/division.png"},
            {id: 15, title: "“ö–æ—Ä—ã—Ç—ã–Ω–¥—ã —Ç–µ—Å—Ç", img: "icons/test.png"}
        ];

        const slider = document.getElementById('slider');
        const nextBtn = document.getElementById('nextBtn');
        const prevBtn = document.getElementById('prevBtn');
        let currentPos = 0;
        const cardWidth = 260; // –∫–∞—Ä—Ç–æ—á–∫–∞ + gap

        // –ö–µ–∑–µ“£–¥–µ—Ä–¥—ñ —à—ã“ì–∞—Ä—É
       // 1. –ï“£ –∞–ª–¥—ã–º–µ–Ω –∂–∞–¥—Ç–∞–Ω “õ–∞–π –∫–µ–∑–µ“£–≥–µ –¥–µ–π—ñ–Ω ”©—Ç—ñ–ª–≥–µ–Ω—ñ–Ω –∞–ª–∞–º—ã–∑
        // –ï–≥–µ—Ä –∂–∞–¥ –±–æ—Å –±–æ–ª—Å–∞, 0-–¥—ñ –∞–ª–∞–º—ã–∑
        let completedStages = parseInt(localStorage.getItem('completed_stages') || 0);

        stages.forEach((s, index) => {
            const card = document.createElement('div');
            
            // –õ–û–ì–ò–ö–ê: 
            // –ë—ñ—Ä—ñ–Ω—à—ñ –∫–µ–∑–µ“£ (index === 0) ”ô—Ä“õ–∞—à–∞–Ω –∞—à—ã“õ –±–æ–ª—É—ã –∫–µ—Ä–µ–∫.
            // “ö–∞–ª“ì–∞–Ω –∫–µ–∑–µ“£–¥–µ—Ä –∞–ª–¥—ã“£“ì—ã –∫–µ–∑–µ“£ –±—ñ—Ç–∫–µ–Ω–¥–µ “ì–∞–Ω–∞ –∞—à—ã–ª–∞–¥—ã.
            let isLocked = index > 0 && index > completedStages;

            card.className = `stage-card ${isLocked ? 'locked' : ''}`;
            
            // –ï–≥–µ—Ä –∫–µ–∑–µ“£ –∞—à—ã“õ –±–æ–ª—Å–∞, –æ“ì–∞–Ω —Å—ñ–ª—Ç–µ–º–µ “õ–æ—Å–∞–º—ã–∑
            if (!isLocked) {
                card.onclick = () => window.location.href = `stage${s.id}.html`;
            } else {
                // –ï–≥–µ—Ä “õ“±–ª—ã–ø—Ç–∞–ª“ì–∞–Ω –±–æ–ª—Å–∞, –±–∞—Å—É“ì–∞ –±–æ–ª–º–∞–π–¥—ã
                card.style.cursor = 'not-allowed';
            }

            // –ï–≥–µ—Ä –∫–µ–∑–µ“£ ”©—Ç—ñ–ª–≥–µ–Ω –±–æ–ª—Å–∞, –æ–Ω—ã –∂–∞—Å—ã–ª —Ç“Ø—Å–ø–µ–Ω –±–µ–ª–≥—ñ–ª–µ–π–º—ñ–∑
            let stageStyle = "";
            if (index < completedStages) {
                stageStyle = "border-color: var(--neon-green); box-shadow: 0 0 15px var(--neon-green);";
            }

            card.style = stageStyle;

            card.innerHTML = `
                <div class="stage-num" style="${index < completedStages ? 'background: var(--neon-green); color: #000;' : ''}">${s.id}</div>
                <div class="stage-icon">
                    <img src="${s.img}" alt="${s.title}" onerror="this.src='https://cdn-icons-png.flaticon.com/512/1141/1141975.png'">
                </div>
                <div class="stage-title">${s.title}</div>
            `;
            slider.appendChild(card);
        });

        // –°–ª–∞–π–¥–µ—Ä–¥—ñ –∂—ã–ª–∂—ã—Ç—É
        nextBtn.onclick = () => {
            if (currentPos > -(cardWidth * 13)) { // 15 - 2 = 13 –∂—ã–ª–∂—ã—Ç—É –º“Ø–º–∫—ñ–Ω–¥—ñ–≥—ñ
                currentPos -= cardWidth;
                slider.style.transform = `translateX(${currentPos}px)`;
                updateButtons();
            }
        };

        prevBtn.onclick = () => {
            if (currentPos < 0) {
                currentPos += cardWidth;
                slider.style.transform = `translateX(${currentPos}px)`;
                updateButtons();
            }
        };

        function updateButtons() {
            prevBtn.disabled = currentPos === 0;
            nextBtn.disabled = currentPos <= -(cardWidth * 13);
        }
    </script>
    <a href="map.html" class="back-home-btn">
        <span class="icon">üè†</span>
        <span class="text">–ë–ò–û-”ò–õ–ï–ú –ö–ê–†–¢–ê–°–´–ù–ê “ö–ê–ô–¢–£</span>
    </a>

</body>
</html>