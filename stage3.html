<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <title>3-кезең: Микроскоп Симуляторы</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Montserrat:wght@300;500&display=swap" rel="stylesheet">
    <style>
        :root { --neon: #00f2ff; --green: #00ff88; --dark: #050a10; }
        body { margin: 0; background: var(--dark); color: white; font-family: 'Montserrat', sans-serif; }

        .game-container { display: grid; grid-template-columns: 400px 1fr; height: 100vh; gap: 20px; padding: 20px; box-sizing: border-box; }

        /* Сол жақ: Теория және тапсырма */
        .info-panel { background: rgba(255,255,255,0.05); border: 1px solid var(--neon); border-radius: 15px; padding: 25px; display: flex; flex-direction: column; }
        .theory-box { flex-grow: 1; background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; margin: 15px 0; border-left: 4px solid var(--neon); }

        /* Оң жақ: Визуалды алаң */
        .work-zone { position: relative; background: radial-gradient(circle, #0a1f33 0%, #000 100%); border-radius: 15px; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        .microscope-img { height: 80%; filter: drop-shadow(0 0 20px rgba(0,242,255,0.2)); transition: 0.5s; }

        /* Интерактивті нүктелер */
        .hotspot { position: absolute; width: 35px; height: 35px; background: var(--neon); border-radius: 50%; border: 4px solid #000; cursor: pointer; display: flex; align-items: center; justify-content: center; font-weight: bold; color: black; box-shadow: 0 0 15px var(--neon); transition: 0.3s; }
        .hotspot:hover { transform: scale(1.2); background: white; }
        .hotspot.checked { background: var(--green); box-shadow: 0 0 15px var(--green); }

        /* Практика: Драг-н-дроп элементтері */
        .drag-item { padding: 10px; background: var(--neon); color: black; border-radius: 5px; margin: 5px; cursor: grab; font-weight: bold; font-size: 0.8rem; display: inline-block; }
        .drop-zone { position: absolute; width: 150px; height: 40px; border: 2px dashed var(--neon); border-radius: 5px; background: rgba(0,242,255,0.1); display: flex; align-items: center; justify-content: center; font-size: 0.7rem; }

        .hidden { display: none; }
        .btn { padding: 15px; border: none; border-radius: 5px; font-family: 'Orbitron'; cursor: pointer; background: var(--neon); font-weight: bold; transition: 0.3s; }
        .btn:disabled { background: #333; cursor: not-allowed; }
    </style>
</head>
<body>

<div class="game-container">
    <div class="info-panel">
        <h2 style="font-family: 'Orbitron'; color: var(--neon);">МИКРОСКОП ҚҰРЫЛЫСЫ</h2>
        <div id="mode-title" style="color: var(--green); font-weight: bold;">МЕҢГЕРУ РЕЖИМІ</div>
        
        <div class="theory-box" id="theory-content">
            Жарық микроскобы — бұл ұсақ биологиялық нысандарды жарық сәулесінің көмегімен үлкейтіп көрсететін оптикалық құрал.
            Микроскоптың құрылысын білу үшін сандарды басып, әр бөлігінің қызметін оқыңыз. Барлық 6 бөлшекті зерттеген соң тапсырмаға көшеміз!
        </div>

        <div id="practice-items" class="hidden">
            <p>Атауларды тиісті орындарға сүйреңіз:</p>
            <div class="drag-item" draggable="true" id="d1">Окуляр</div>
            <div class="drag-item" draggable="true" id="d2">Объективтер</div>
            <div class="drag-item" draggable="true" id="d3">Тубус</div>
            <div class="drag-item" draggable="true" id="d4">Заттық үстелше</div>
            <div class="drag-item" draggable="true" id="d5">Бұрандалар</div>
            <div class="drag-item" draggable="true" id="d6">Айна</div>
        </div>

        <button id="start-test" class="btn" disabled onclick="enablePractice()">СЫНАҚҚА ӨТУ</button>
    </div>

    <div class="work-zone" id="work-zone">
        <img src="микроскоп.png" class="microscope-img" id="main-img">

        <div class="hotspot" style="top:12%; left:37%;" onclick="showInfo('okular', this)">1</div>
        <div class="hotspot" style="top:28%; left:45%;" onclick="showInfo('tubus', this)">2</div>
        <div class="hotspot" style="top:48%; left:55%;" onclick="showInfo('objektiv', this)">3</div>
        <div class="hotspot" style="top:60%; left:50%;" onclick="showInfo('table', this)">4</div>
        <div class="hotspot" style="top:60%; left:40%;" onclick="showInfo('screw', this)">5</div>
        <div class="hotspot" style="top:70%; left:50%;" onclick="showInfo('mirror', this)">6</div>

        <div class="drop-zone hidden" style="top:8%; left:30%;" data-accept="Окуляр">?</div>
        <div class="drop-zone hidden" style="top:25%; left:30%;" data-accept="Тубус">?</div>
        <div class="drop-zone hidden" style="top:45%; left:55%;" data-accept="Объективтер">?</div>
        <div class="drop-zone hidden" style="top:58%; left:60%;" data-accept="Заттық үстелше">?</div>
        <div class="drop-zone hidden" style="top:60%; left:25%;" data-accept="Бұрандалар">?</div>
        <div class="drop-zone hidden" style="top:70%; left:50%;" data-accept="Айна">?</div>
    </div>
</div>

<script>
    const theoryData = {
        okular: { t: "Окуляр", d: "Микроскоптың ең жоғарғы бөлігі. Ол арқылы бақылаушы нысанды көреді. Нысанды 7-ден 20 есеге дейін үлкейтеді." },
        tubus: { t: "Тубус", d: "Окуляр мен объективтің арақашықтығын сақтап тұратын металл түтікше." },
        objektiv: { t: "Объективтер", d: "Нысанға бағытталған ең басты үлкейткіш бөлік. Револьверде бірнеше объектив болады." },
        table: { t: "Заттық үстелше", desc: "Заттық үстелше — үстіне микропрепарат қойылатын орын. Ортасында жарық өтетін тесігі бар." },
        screw: { t: "Бұрандалар", d: "Кескіннің анықтығын реттейді. Макробұранда тубусты тез қозғалтса, микробұранда фокусты дәл келтіреді." },
        mirror: { t: "Айна / Жарық", d: "Жарықты жинап, зерттелетін нысанға бағыттайды." }
    };

    let explored = new Set();

    function showInfo(id, el) {
        const item = theoryData[id];
        document.getElementById('theory-content').innerHTML = `<h3>${item.t}</h3><p>${item.d || item.desc}</p>`;
        el.classList.add('checked');
        explored.add(id);
        if(explored.size === 6) document.getElementById('start-test').disabled = false;
    }

    function enablePractice() {
        document.getElementById('mode-title').innerText = "ПРАКТИКАЛЫҚ ТАПСЫРМА";
        document.getElementById('theory-content').classList.add('hidden');
        document.getElementById('practice-items').classList.remove('hidden');
        document.getElementById('start-test').classList.add('hidden');
        
        document.querySelectorAll('.hotspot').forEach(h => h.remove());
        document.querySelectorAll('.drop-zone').forEach(z => z.classList.remove('hidden'));
        document.getElementById('main-img').style.opacity = "0.3";
    }

    // Drag and Drop Logic
    let draggedItem = null;
    document.querySelectorAll('.drag-item').forEach(item => {
        item.addEventListener('dragstart', () => { draggedItem = item; });
    });

    document.querySelectorAll('.drop-zone').forEach(zone => {
        zone.addEventListener('dragover', e => e.preventDefault());
        zone.addEventListener('drop', () => {
            if(draggedItem.innerText === zone.dataset.accept) {
                zone.innerHTML = draggedItem.innerText;
                zone.style.background = "var(--green)";
                zone.style.color = "black";
                draggedItem.remove();
                checkWin();
            } else {
                alert("Қате орын!");
            }
        });
    });

    function checkWin() {
        if(document.querySelectorAll('.drag-item').length === 0) {
            alert("Керемет! Сіз микроскоп құрылысын толық меңгердіңіз.");
            window.location.href = "stage4.html";
        }
    }
</script>
</body>
</html>